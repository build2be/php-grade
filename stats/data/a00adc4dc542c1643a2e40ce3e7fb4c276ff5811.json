{"filename":"src\/Parsers\/PhpSecurityParser.php","lines":[{"nr":1,"line":"<?php","msg":[]},{"nr":2,"line":"\/**","msg":[]},{"nr":3,"line":" * Created by PhpStorm.","msg":[]},{"nr":4,"line":" * User: martijn","msg":[]},{"nr":5,"line":" * Date: 27-6-14","msg":[]},{"nr":6,"line":" * Time: 10:29","msg":[]},{"nr":7,"line":" *\/","msg":[{"tool":"phpcs","level":2,"message":"PHP version not specified"},{"tool":"phpcs","level":2,"message":"Missing @category tag in file comment"},{"tool":"phpcs","level":2,"message":"Missing @package tag in file comment"},{"tool":"phpcs","level":2,"message":"Missing @author tag in file comment"},{"tool":"phpcs","level":2,"message":"Missing @license tag in file comment"},{"tool":"phpcs","level":2,"message":"Missing @link tag in file comment"}]},{"nr":8,"line":"","msg":[]},{"nr":9,"line":"namespace PhpGrade\\Parsers;","msg":[]},{"nr":10,"line":"","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":11,"line":"","msg":[]},{"nr":12,"line":"use PhpGrade\\Config;","msg":[]},{"nr":13,"line":"use PhpGrade\\Message;","msg":[]},{"nr":14,"line":"use PhpGrade\\MessageList;","msg":[]},{"nr":15,"line":"use SensioLabs\\Security\\SecurityChecker;","msg":[]},{"nr":16,"line":"use Symfony\\Component\\Finder\\Finder;","msg":[{"tool":"phpdcd","level":0,"message":"87 lines of dead code"},{"tool":"phpdcd","level":0,"message":"5 lines of dead code"},{"tool":"phpdcd","level":0,"message":"10 lines of dead code"},{"tool":"phpdcd","level":0,"message":"6 lines of dead code"}]},{"nr":17,"line":"","msg":[{"tool":"phpdcd","level":0,"message":"11 lines of dead code"},{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":18,"line":"class PhpSecurityParser extends BaseParser implements ParserInterface","msg":[{"tool":"phpcs","level":2,"message":"Missing class doc comment"}]},{"nr":19,"line":"{","msg":[{"tool":"phpdcd","level":0,"message":"18 lines of dead code"}]},{"nr":20,"line":"","msg":[{"tool":"phpdcd","level":0,"message":"6 lines of dead code"}]},{"nr":21,"line":"    public function run(Finder $iterator, MessageList &$messageList)","msg":[{"tool":"phpcs","level":2,"message":"Missing function doc comment"},{"tool":"phpdcd","level":0,"message":"14 lines of dead code"},{"tool":"phpdcd","level":0,"message":"21 lines of dead code"},{"tool":"phpdcd","level":0,"message":"19 lines of dead code"},{"tool":"phpdcd","level":0,"message":"32 lines of dead code"}]},{"nr":22,"line":"    {","msg":[{"tool":"phpdcd","level":0,"message":"10 lines of dead code"}]},{"nr":23,"line":"        $composerIterator = $iterator->name(\"composer.lock\");","msg":[{"tool":"phpdcd","level":0,"message":"27 lines of dead code"}]},{"nr":24,"line":"        $composerLockFiles = iterator_to_array($composerIterator, false);","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":25,"line":"        if (count($composerLockFiles) > 0) {","msg":[{"tool":"phpdcd","level":0,"message":"41 lines of dead code"},{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":26,"line":"            $checker = new SecurityChecker();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\SensioLabs\\Security\\SecurityChecker' in method 'run'."}]},{"nr":27,"line":"            $report = $checker->check((string)$composerLockFiles[0], 'json');","msg":[{"tool":"phpdcd","level":0,"message":"6 lines of dead code"}]},{"nr":28,"line":"            $report = json_decode($report, true);","msg":[]},{"nr":29,"line":"","msg":[{"tool":"phpdcd","level":0,"message":"8 lines of dead code"}]},{"nr":30,"line":"            $jsonFile = str_replace('composer.lock', 'composer.json', $composerLockFiles[0]);","msg":[{"tool":"phpcs","level":2,"message":"Line exceeds 85 characters; contains 93 characters"},{"tool":"phpdcd","level":0,"message":"9 lines of dead code"}]},{"nr":31,"line":"","msg":[]},{"nr":32,"line":"            $composerJson = file($jsonFile);","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":33,"line":"            $result = array();","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":34,"line":"            foreach ($report as $name => $info) {","msg":[{"tool":"phpdcd","level":0,"message":"6 lines of dead code"}]},{"nr":35,"line":"                foreach ($composerJson as $lineNr => $line) {","msg":[]},{"nr":36,"line":"                    if (strpos($line, $name) !== false) {","msg":[{"tool":"phpdcd","level":0,"message":"31 lines of dead code"}]},{"nr":37,"line":"","msg":[]},{"nr":38,"line":"                        foreach ($info['advisories'] as $aInfo) {","msg":[{"tool":"phpdcd","level":0,"message":"53 lines of dead code"}]},{"nr":39,"line":"                            $messageObject = new Message('security');","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Message' in method 'run'."}]},{"nr":40,"line":"                            $messageObject->setLine($lineNr + 1);","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":41,"line":"                            $messageObject->setErrorLevel(Message::LEVEL_ERROR);","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Message' in method 'run'."},{"tool":"phpdcd","level":0,"message":"4 lines of dead code"},{"tool":"phpdcd","level":0,"message":"4 lines of dead code"},{"tool":"phpdcd","level":0,"message":"31 lines of dead code"}]},{"nr":42,"line":"                            $message = $aInfo['title'] . ' (' . $aInfo['link'] . ')' . PHP_EOL;","msg":[{"tool":"phpcs","level":2,"message":"Line exceeds 85 characters; contains 95 characters"}]},{"nr":43,"line":"                            $messageObject->setMessage($message);","msg":[]},{"nr":44,"line":"                            $result[$lineNr][] = $messageObject;","msg":[]},{"nr":45,"line":"                        }","msg":[]},{"nr":46,"line":"                    }","msg":[]},{"nr":47,"line":"                }","msg":[]},{"nr":48,"line":"            }","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":49,"line":"","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":50,"line":"            $messageList->addMessages($jsonFile, $result);","msg":[]},{"nr":51,"line":"        }","msg":[]},{"nr":52,"line":"    }","msg":[]},{"nr":53,"line":"","msg":[]},{"nr":54,"line":"} ","msg":[]}]}