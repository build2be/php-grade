{"filename":"src\/Commands\/RunCommand.php","lines":[{"nr":1,"line":"<?php","msg":[]},{"nr":2,"line":"","msg":[{"tool":"phpcs","level":2,"message":"Missing file doc comment"}]},{"nr":3,"line":"namespace PhpGrade\\Commands;","msg":[]},{"nr":4,"line":"","msg":[]},{"nr":5,"line":"use PhpGrade\\Formatters\\AngularFormatter;","msg":[]},{"nr":6,"line":"use PhpGrade\\Formatters\\ConsoleFormatter;","msg":[]},{"nr":7,"line":"use PhpGrade\\Formatters\\YamlFormatter;","msg":[]},{"nr":8,"line":"use PhpGrade\\MessageList;","msg":[]},{"nr":9,"line":"use PhpGrade\\Parsers\\ParserInterface;","msg":[]},{"nr":10,"line":"use PhpGrade\\Parsers\\PhpCpdParser;","msg":[{"tool":"phpdcd","level":0,"message":"4 lines of dead code"},{"tool":"phpdcd","level":0,"message":"4 lines of dead code"}]},{"nr":11,"line":"use PhpGrade\\Parsers\\PhpCsParser;","msg":[]},{"nr":12,"line":"use PhpGrade\\Parsers\\PhpDcdParser;","msg":[]},{"nr":13,"line":"use PhpGrade\\Parsers\\PhpMdParser;","msg":[]},{"nr":14,"line":"use PhpGrade\\Parsers\\PhpSecurityParser;","msg":[]},{"nr":15,"line":"use Symfony\\Component\\Console\\Input\\InputArgument;","msg":[]},{"nr":16,"line":"use Symfony\\Component\\Console\\Input\\InputInterface;","msg":[]},{"nr":17,"line":"use Symfony\\Component\\Console\\Input\\InputOption;","msg":[]},{"nr":18,"line":"use Symfony\\Component\\Console\\Output\\OutputInterface;","msg":[]},{"nr":19,"line":"use Symfony\\Component\\Finder\\Finder;","msg":[]},{"nr":20,"line":"","msg":[]},{"nr":21,"line":"","msg":[]},{"nr":22,"line":"class RunCommand extends BaseCommand","msg":[{"tool":"phpcs","level":2,"message":"Missing class doc comment"},{"tool":"phpmd","level":0,"message":"The class RunCommand has a coupling between objects value of 15. Consider to reduce the number of dependencies under 13."}]},{"nr":23,"line":"{","msg":[]},{"nr":24,"line":"","msg":[]},{"nr":25,"line":"    protected function configure()","msg":[{"tool":"phpcs","level":2,"message":"Missing function doc comment"},{"tool":"phpdcd","level":0,"message":"41 lines of dead code"},{"tool":"phpdcd","level":0,"message":"41 lines of dead code"}]},{"nr":26,"line":"    {","msg":[]},{"nr":27,"line":"        $this","msg":[]},{"nr":28,"line":"          ->setName('run')","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":29,"line":"          ->setDescription('Run all available grading types.')","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":30,"line":"          ->addOption(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":31,"line":"            'tests',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":32,"line":"            't',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":33,"line":"            InputOption::VALUE_REQUIRED | InputOption::VALUE_IS_ARRAY,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputOption' in method 'configure'."},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputOption' in method 'configure'."}]},{"nr":34,"line":"            'Test programs to run (all by default) options: phpcs, phpmd, phpdcd, phpcpd.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpcs","level":2,"message":"Line exceeds 85 characters; contains 90 characters"}]},{"nr":35,"line":"          )","msg":[]},{"nr":36,"line":"          ->addOption(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":37,"line":"            'formatter',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":38,"line":"            'f',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":39,"line":"            InputOption::VALUE_REQUIRED,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputOption' in method 'configure'."}]},{"nr":40,"line":"            'Set output formatter (console by default) options: console, yaml, angular.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpcs","level":2,"message":"Line exceeds 85 characters; contains 88 characters"}]},{"nr":41,"line":"          )","msg":[]},{"nr":42,"line":"          ->addOption(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":43,"line":"            'output',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":44,"line":"            'o',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":45,"line":"            InputOption::VALUE_REQUIRED,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputOption' in method 'configure'."}]},{"nr":46,"line":"            'Output directory for angular formatter.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":47,"line":"          )","msg":[]},{"nr":48,"line":"          ->addOption(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":49,"line":"            'serve',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":50,"line":"            's',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":51,"line":"            InputOption::VALUE_NONE,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputOption' in method 'configure'."}]},{"nr":52,"line":"            'Run PHP built-in webserver on the output directory for angular.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":53,"line":"          )","msg":[]},{"nr":54,"line":"          ->addArgument(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":55,"line":"            'location',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":56,"line":"            InputArgument::REQUIRED,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputArgument' in method 'configure'."}]},{"nr":57,"line":"            'Location to grade. This can be a file or directory.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":58,"line":"          )","msg":[]},{"nr":59,"line":"          ->addArgument(","msg":[{"tool":"phpcs","level":2,"message":"Object operator not indented correctly; expected 12 spaces but found 10"}]},{"nr":60,"line":"            'verbose',","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":61,"line":"            InputArgument::OPTIONAL,","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"},{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Console\\Input\\InputArgument' in method 'configure'."}]},{"nr":62,"line":"            'Show verbose information.'","msg":[{"tool":"phpcs","level":2,"message":"Multi-line function call not indented correctly; expected 14 spaces but found 12"}]},{"nr":63,"line":"          );","msg":[]},{"nr":64,"line":"","msg":[]},{"nr":65,"line":"    }","msg":[]},{"nr":66,"line":"","msg":[]},{"nr":67,"line":"    \/**","msg":[{"tool":"phpcs","level":2,"message":"Doc comment for \"$input\" missing"},{"tool":"phpcs","level":2,"message":"Doc comment for \"$output\" missing"}]},{"nr":68,"line":"     * Run all available grading (sub) commands","msg":[]},{"nr":69,"line":"     *\/","msg":[{"tool":"phpcs","level":2,"message":"Missing @return tag in function comment"}]},{"nr":70,"line":"    protected function execute(InputInterface $input, OutputInterface $output)","msg":[{"tool":"phpmd","level":0,"message":"The method execute() has a Cyclomatic Complexity of 23. The configured cyclomatic complexity threshold is 10."},{"tool":"phpmd","level":0,"message":"The method execute() has an NPath complexity of 373248. The configured NPath complexity threshold is 200."},{"tool":"phpdcd","level":0,"message":"89 lines of dead code"}]},{"nr":71,"line":"    {","msg":[]},{"nr":72,"line":"        $location = $input->getArgument('location');","msg":[]},{"nr":73,"line":"        if (!file_exists($location)) {","msg":[]},{"nr":74,"line":"            throw new \\Exception(\"Location $location does not exists.\");","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Exception' in method 'execute'."}]},{"nr":75,"line":"        }","msg":[]},{"nr":76,"line":"","msg":[]},{"nr":77,"line":"        $tools = $input->getOption('tests');","msg":[]},{"nr":78,"line":"        if (empty($tools) || $tools === null) {","msg":[]},{"nr":79,"line":"            $tools = array('all');","msg":[]},{"nr":80,"line":"        }","msg":[]},{"nr":81,"line":"","msg":[]},{"nr":82,"line":"        $parsers = array();","msg":[]},{"nr":83,"line":"        if (in_array('phpcs', $tools) || in_array('all', $tools)) {","msg":[]},{"nr":84,"line":"            $parsers[] = new PhpCsParser();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Parsers\\PhpCsParser' in method 'execute'."}]},{"nr":85,"line":"        }","msg":[]},{"nr":86,"line":"        if (in_array('phpmd', $tools) || in_array('all', $tools)) {","msg":[]},{"nr":87,"line":"            $parsers[] = new PhpMdParser();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Parsers\\PhpMdParser' in method 'execute'."}]},{"nr":88,"line":"        }","msg":[]},{"nr":89,"line":"        if (in_array('phpcpd', $tools) || in_array('all', $tools)) {","msg":[]},{"nr":90,"line":"            $parsers[] = new PhpCpdParser();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Parsers\\PhpCpdParser' in method 'execute'."}]},{"nr":91,"line":"        }","msg":[]},{"nr":92,"line":"        if (in_array('phpdcd', $tools) || in_array('all', $tools)) {","msg":[]},{"nr":93,"line":"            $parsers[] = new PhpDcdParser();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Parsers\\PhpDcdParser' in method 'execute'."}]},{"nr":94,"line":"        }","msg":[]},{"nr":95,"line":"        if (in_array('security', $tools) || in_array('all', $tools)) {","msg":[]},{"nr":96,"line":"            $parsers[] = new PhpSecurityParser();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Parsers\\PhpSecurityParser' in method 'execute'."}]},{"nr":97,"line":"        }","msg":[]},{"nr":98,"line":"","msg":[]},{"nr":99,"line":"        $finder = new Finder();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\Symfony\\Component\\Finder\\Finder' in method 'execute'."}]},{"nr":100,"line":"","msg":[]},{"nr":101,"line":"        \/\/ Skip vendor directories","msg":[]},{"nr":102,"line":"        $finder->files()->in($location)->notPath(\"vendor\");","msg":[]},{"nr":103,"line":"","msg":[]},{"nr":104,"line":"        \/\/ List of messages generated by each grader.","msg":[]},{"nr":105,"line":"        $messages = new MessageList();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\MessageList' in method 'execute'."}]},{"nr":106,"line":"","msg":[]},{"nr":107,"line":"        foreach ($parsers as $parser) {","msg":[]},{"nr":108,"line":"            \/**","msg":[]},{"nr":109,"line":"             * @var Finder $finderInstance","msg":[]},{"nr":110,"line":"             *\/","msg":[]},{"nr":111,"line":"            $finderInstance = clone $finder;","msg":[]},{"nr":112,"line":"            \/**","msg":[]},{"nr":113,"line":"             * @var ParserInterface $parser","msg":[]},{"nr":114,"line":"             *\/","msg":[]},{"nr":115,"line":"            $parser->run($finderInstance, $messages);","msg":[]},{"nr":116,"line":"        }","msg":[]},{"nr":117,"line":"","msg":[]},{"nr":118,"line":"        if ($input->getOption('formatter') === null) {","msg":[]},{"nr":119,"line":"            $formatter = 'console';","msg":[]},{"nr":120,"line":"        } else {","msg":[{"tool":"phpmd","level":0,"message":"The method execute uses an else expression. Else is never necessary and you can simplify the code to work without else."}]},{"nr":121,"line":"            $formatter = $input->getOption('formatter');","msg":[]},{"nr":122,"line":"        }","msg":[]},{"nr":123,"line":"","msg":[]},{"nr":124,"line":"        if ($formatter == 'console') {","msg":[]},{"nr":125,"line":"            $formatter = new ConsoleFormatter();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Formatters\\ConsoleFormatter' in method 'execute'."}]},{"nr":126,"line":"        }","msg":[]},{"nr":127,"line":"        if ($formatter == 'yaml') {","msg":[]},{"nr":128,"line":"            $formatter = new YamlFormatter();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Formatters\\YamlFormatter' in method 'execute'."}]},{"nr":129,"line":"        }","msg":[]},{"nr":130,"line":"        $output = $input->getOption('output');","msg":[]},{"nr":131,"line":"        $serve = $input->getOption('serve');","msg":[]},{"nr":132,"line":"","msg":[]},{"nr":133,"line":"        if (!is_null($serve)) {","msg":[]},{"nr":134,"line":"           $formatter = 'angular';","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected at least 12 spaces, found 11"}]},{"nr":135,"line":"           if (is_null($output)) {","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected 12 spaces, found 11"}]},{"nr":136,"line":"             $tempfile=tempnam(sys_get_temp_dir(),'phpgrade-');","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected at least 16 spaces, found 13"},{"tool":"phpcs","level":2,"message":"No space found after comma in function call"}]},{"nr":137,"line":"             if (file_exists($tempfile)) {","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected 16 spaces, found 13"}]},{"nr":138,"line":"               unlink($tempfile);","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected at least 20 spaces, found 15"}]},{"nr":139,"line":"             }","msg":[]},{"nr":140,"line":"             mkdir($tempfile);","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected at least 16 spaces, found 13"}]},{"nr":141,"line":"             $output = $tempfile;","msg":[{"tool":"phpcs","level":2,"message":"Line indented incorrectly; expected at least 16 spaces, found 13"}]},{"nr":142,"line":"           }","msg":[]},{"nr":143,"line":"        }","msg":[]},{"nr":144,"line":"","msg":[]},{"nr":145,"line":"        if ($input->getOption('verbose')) {","msg":[]},{"nr":146,"line":"            echo \"Serve : $serve\" . PHP_EOL;","msg":[]},{"nr":147,"line":"            echo \"Output dir: $output\" . PHP_EOL;","msg":[]},{"nr":148,"line":"            echo \"Format: $formatter\" . PHP_EOL;","msg":[]},{"nr":149,"line":"        }","msg":[]},{"nr":150,"line":"","msg":[]},{"nr":151,"line":"        if ($formatter == 'angular') {","msg":[]},{"nr":152,"line":"            $formatter = new AngularFormatter();","msg":[{"tool":"phpmd","level":0,"message":"Avoid using static access to class '\\PhpGrade\\Formatters\\AngularFormatter' in method 'execute'."}]},{"nr":153,"line":"            $formatter->format($messages->getMessages(), $output, $serve);","msg":[]},{"nr":154,"line":"        }else{","msg":[{"tool":"phpcs","level":2,"message":"Expected \"} else {\\n\"; found \"}else{\\n\""},{"tool":"phpmd","level":0,"message":"The method execute uses an else expression. Else is never necessary and you can simplify the code to work without else."}]},{"nr":155,"line":"            $formatter->format($messages->getMessages());","msg":[]},{"nr":156,"line":"        }","msg":[]},{"nr":157,"line":"","msg":[]},{"nr":158,"line":"    }","msg":[]},{"nr":159,"line":"}","msg":[]}]}